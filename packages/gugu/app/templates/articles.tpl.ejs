<template>
  <div>
    <div class="space-y-12 mb-8">
      <% articles.forEach(article => { %>
      <article>
        <h1 class="text-xl font-bold text-accent transition-colors">
          <router-link
            :to="'/post/<%- article.frontmatter.id %>#more'"
            class="post-title underline-offset-6 decoration-dashed hover:underline"
          >
            <%- article.frontmatter.title %>
          </router-link>
        </h1>

        <PostMetaInfo
          class="my-3"
          :meta="metaMap['<%- article.frontmatter.id %>']"
        />

        <Markdown> <%- article.excerpt %> </Markdown>
      </article>
      <% }) %>
    </div>

    <Pagination
      :current="<%= current %>"
      :total="<%= total %>"
      pattern="/page/:page"
    />
  </div>
</template>

<script setup lang="ts">
  import Markdown from '@app/components/markdown.vue';
  import PostMetaInfo from '@app/components/post/meta-info.vue';
  import Pagination from '@app/components/pagination.vue';
  import ALink from '@app/components/a-link.vue';

  defineOptions({
    name: 'Articles',
  });

  const metaMap = JSON.parse(
    '<%- JSON.stringify(Object.fromEntries(articles.map((article) => [article.frontmatter.id, { ...article.frontmatter, isDraft: article.isDraft }]))) %>',
  );
</script>
